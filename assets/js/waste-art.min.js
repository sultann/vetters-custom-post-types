/**
 * Waste Art - v0.1.0 - 2017-06-27 | http://pluginever.com | Copyright (c) 2017; | Licensed GPLv2+
 */

window.Waste_Art=function(e,t,i,a){"use strict";var n={};return n.init=function(){function n(e,t){i.ajax({type:"GET",url:jsobject.ajaxurl,data:{term_id:e,action:"get_waste_art_containers"},success:function(e){if(!0===e.success){var a=r(e.data,t);i("#wast-art-items .row").html(a),i(".container-title").html(t)}console.log(e)},error:function(){console.log("error")}})}function r(e,t){var n="";return i.each(e,function(e,r){n+='<div class="col-md-4">',n+='<div class="waste-container-single">',n+='<form action="'+jsobject.form_page+'" method="get" class="container-selector-form">',n+="<h3>"+r.title+"</h3>",n+='<img src="'+r.image+'">',n+='<select class="container-size-selector" name="container-size">',r.dropdown!==a&&(n+='<option value="">Containergröße</option>',i.each(r.dropdown,function(e,t){n+='<option value="'+t+'">'+t+"</option>"})),n+="</select>",n+='<input type="hidden" name="abfallart" value="'+t+'">',n+='<input type="hidden" name="container" value="'+r.title+'">',n+='<input class="container-submit-btn" type="submit" value="Bestellen">',n+="</form>",n+="</div>",n+="</div>"}),n}function s(){var e=!0;i(".waster-art-input").each(function(){if(console.log(i(this).val()),""==i(this).val())return e=!1,console.log(e),!1}),e?i(".waste-art-form-submit, .print-form-btn").removeAttr("disabled"):i(".waste-art-form-submit, .print-form-btn").attr("disabled","disabled")}function o(){var t=e.open("","print","width=600,height=450,status,scrollbars,resizable,screenX=20,screenY=40,left=20,top=40");t.document.write("<html><head>"),t.document.write('<style type="text/css">@media print{#printcontrols {display:none;}}</style>'),t.document.write('<link rel="stylesheet" type="text/css" href="'+jsobject.printcss+'" />'),t.document.write('<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,700" rel="stylesheet">'),t.document.write('</head><body class="pdf">'),t.document.write('<span id="printcontrols" style="float:right;">'),t.document.write('<a href="javascript:window.print();">Drucken</a>'),t.document.write(' | <a href="javascript:window.close();">Schließen</a>'),t.document.write("</span>"),t.document.write('<div class="header"><div class="tagling">Auftrag für die Entleerung eines VOCUS-Umleercontainer</div>'),t.document.write('<div class="logo"><img src="'+jsobject.logo+'"></div></div>'),t.document.write(l()),t.document.write("</body></html>"),t.document.close(),t.focus()}function l(){var e=jQuery('*[name="abfallart"]').val(),i=jQuery('*[name="email"]').val(),a=(jQuery('*[name="besteller"]').val(),jQuery('*[name="state"],*[name="zip"],*[name="city"]').val()),n=jQuery('*[name="phone"]').val(),r=jQuery('*[name="date"]').val(),s=(jQuery('*[name="state"]').val(),jQuery('*[name="zip"]').val()),o=jQuery('*[name="city"]').val(),l=jQuery('*[name="kundennummer"]').val(),c=jQuery('*[name="abfallart"]').val(),d=jQuery('*[name="container"]').val(),v=new Date,f=v.getDate(),u=v.getMonth()+1,m=v.getFullYear(),p=v.getHours(),h=v.getMinutes(),g=jQuery('input[name="besteller"]').val(),w=t.createElement("div");w.innerHTML='<div class="info-1"> <div class="info-left"><p>Fahrauftrag</p></div><div class="info-left"> <ul> <li>Datum: '+f+"."+u+"."+m+"</il> <li>Zeit: "+p+":"+h+'</il> <li>Auftrag per Onlineformular via Postversand</il> </ul> </div></div><div class="line"></div><div class="info-2"> <div class="info-left"><span>Leeren</span></div><div class="info-left"> <ul> <li>VOCUS-Container :'+e+"</il> <li>Abfallart: "+c+"</il><li>Container: "+d+"</il> <li>"+r+'</il> </ul> </div></div><div class="clear"></div><div class="info-4"> <div class="info-left">Kundennummer</div><div class="info-left">'+l+'</div></div><div class="clear"></div><div class="info-4"> <div class="info-left">Besteller/in</div><div class="info-left">'+g+'</div></div><div class="info-3"> <div class="info-left">Auftraggeber</div><div class="info-left"> <ul> <li>'+a+"</il> <li>"+s+"</il> <li>"+o+'</il> </ul> </div></div><div class="clear"></div><div class="info-4"> <div class="info-left">Telefon</div><div class="info-left">'+n+'</div></div><div class="clear"></div><div class="info-4"> <div class="info-left">E-Mail</div><div class="info-left">'+i+'</div></div><div class="clear"></div><div class="info-6"> <div class="info-left"> <div class="line"></div><div class="sign">Unterschrift Marco Mustermann</div></div><div class="info-left"></div></div><div class="clear"></div><div class="info-7"> <div class="info-left"></div><div class="info-left">Der Auftraggeber hat von den, von Vetter Umwelt Service geforderten Geschaftsbedingungen Kenntnis genommen. (einzusehen unter <?php echo get_home_url(); ?> ) </div></div>';for(var b=w.innerHTML.toString(),y=w.getElementsByTagName("a"),j=0;j<y.length;j++){var _=t.createElement("div");_.appendChild(y[j].cloneNode(!0));var Q=_.innerHTML.toString(),k=y[j].innerHTML.toString();b=b.replace(Q,k)}return b}i(".waste-arts-item").bind("click",function(){var e=i(this).data("term-id"),t=i(this).text();if(e!=a)return n(e,t),!1}),i(t).on("click",".container-submit-btn",function(e){e.preventDefault();var t=i(this).closest("form");if(""===t.find(".container-size-selector").val())return!1;t.submit()}),i(".waste-date-picker").datepicker(),s(),i(".waster-art-input").on("change",function(){s()}),i(".waste-art-container-form").on("submit",function(t){t.preventDefault();var a=i(this).serializeArray();e.waster_art_form_data=a,console.log(i(this).serializeArray());for(var n=0;n<a.length;n++){var r=a[n].name,s=a[n].value;i(".waste-form-confirmation").find(".waste-art-"+r).text(s)}i(".waste-art-container-form-step-1").hide(),i(".waste-art-container-form-step-2").show()}),i(".waster-art-form-edit-btn").on("click",function(){i(".waste-art-container-form-step-1").show(),i(".waste-art-container-form-step-2").hide()}),i(".waste-submit-form").on("click",function(){if(0==i(".check-confirm").is(":checked"))return i(".declaimer-line").hasClass("error")||i(".declaimer-line").addClass("error"),!0;var t=i(".waste-art-container-form").data("emails");t==a&&alert("code:10001, something went wrong please try again.");var n=e.waster_art_form_data;n==a&&alert("code:10002, something went wrong please try again."),i.ajax({type:"POST",url:jsobject.ajaxurl,data:{emails:t,form_fields:n,action:"get_waste_art_form_submit"},success:function(e){!0===e.success&&(i(".waste-art-container-form-step-2").hide(),i(".waste-art-container-form-step-3").show())},error:function(){console.log("error")}})}),i(".print-form-btn").on("click",function(){i(this).is(":disabled")?console.log("disabled"):o()}),i(".waster-art-input").on("change",function(){var e=i(this).val();if(e.length<3)return!1;i.ajax({type:"GET",url:jsobject.ajaxurl,data:{customer_id:e,action:"get_customer_name_by_id"},success:function(e){!0===e.success&&i(".waste-art-saved-customer-name").text("-"+e.data.name),console.log(e)},error:function(){console.log("error")}})})},i(t).ready(n.init),n}(window,document,jQuery);